<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Sukie" />



<meta name="description" content="日志收集系统">
<meta property="og:type" content="article">
<meta property="og:title" content="Flume学习">
<meta property="og:url" content="https://sukie-sun.github.io/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Sukie&#39;s Blog">
<meta property="og:description" content="日志收集系统">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wx1.sinaimg.cn/large/005zftzDly1g1jra7eyl9j30gi0e5jt8.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/large/005zftzDly1g1jrc5v43yj30me071q39.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/large/005zftzDly1g1jrhaxmslj30mx0dbju2.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/large/005zftzDly1g1jri44xz1j30l80d00uq.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/large/005zftzDgy1fzb4acaz5fj30u10blmzc.jpg">
<meta property="og:image" content="https://wx1.sinaimg.cn/large/005zftzDgy1fzb4bsv8d2j30wd08k74i.jpg">
<meta property="article:published_time" content="2019-01-17T16:00:00.000Z">
<meta property="article:modified_time" content="2020-08-07T13:07:21.741Z">
<meta property="article:author" content="Sukie">
<meta property="article:tag" content="flume">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wx1.sinaimg.cn/large/005zftzDly1g1jra7eyl9j30gi0e5jt8.jpg">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Sukie&#39;s Blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Flume学习 | Sukie&#39;s Blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
<script src=""></script>
<script src=""></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 5.0.0"><link rel="stylesheet" href="/css/prism-a11y-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Sukie</a></h1>
        </hgroup>

        
        <p class="header-subtitle">你好，新世界、新编程</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/essays/">随笔</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                            <li><a href="/logs/">更新日志</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Array/" rel="tag">Array</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS-6/" rel="tag">CentOS 6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HBase/" rel="tag">HBase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HDFS/" rel="tag">HDFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/" rel="tag">Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux%E5%91%BD%E4%BB%A4/" rel="tag">Linux命令</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/" rel="tag">Linux系统环境</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/List/" rel="tag">List</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Map/" rel="tag">Map</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapReduce/" rel="tag">MapReduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RDD%E7%AE%97%E5%AD%90/" rel="tag">RDD算子</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Set/" rel="tag">Set</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark-shell/" rel="tag">Spark shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SparkSql/" rel="tag">SparkSql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SparkStreaming/" rel="tag">SparkStreaming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SparkUI/" rel="tag">SparkUI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark%E6%A1%86%E6%9E%B6/" rel="tag">Spark框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sqoop/" rel="tag">Sqoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Storm%EF%BC%8C%E6%B5%81%E5%BC%8F%E5%A4%84%E7%90%86%E6%A1%86%E6%9E%B6/" rel="tag">Storm，流式处理框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/String/" rel="tag">String</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/" rel="tag">Zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/" rel="tag">flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/" rel="tag">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sparkcore%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B/" rel="tag">sparkcore应用案例</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yarn/" rel="tag">yarn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8D%E5%90%8C%E6%95%B0%E6%8D%AE%E6%BA%90/" rel="tag">不同数据源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E5%85%B4%E8%B6%A3/" rel="tag">个人兴趣</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%9C%E7%B4%A2%E5%92%8C%E5%88%86%E6%9E%90%E5%BC%95%E6%93%8E/" rel="tag">分布式搜索和分析引擎</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%A6%BB%E7%BA%BF%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6/" rel="tag">分布式离线计算框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E8%80%8C%E6%B2%BB%E4%B9%8B/" rel="tag">分而治之</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2/" rel="tag">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E4%BA%8E%E5%86%85%E5%AD%98/" rel="tag">基于内存</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%81%E8%A3%85RDD/" rel="tag">封装RDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%BF%E6%92%AD/" rel="tag">广播</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%81%E5%BC%8F%E5%A4%84%E7%90%86%E6%A1%86%E6%9E%B6/" rel="tag">流式处理框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%B3%BB%E7%BB%9F/" rel="tag">消息队列系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag">源码分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B4%AF%E5%8A%A0%E5%99%A8/" rel="tag">累加器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" rel="tag">编程语言</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8E/" rel="tag">计算引擎</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6/" rel="tag">计算框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%99%E6%80%81/" rel="tag">静态</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">新世界编程</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Sukie</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Sukie</a></h1>
            </hgroup>
            
            <p class="header-subtitle">你好，新世界、新编程</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/essays/">随笔</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                    <li><a href="/logs/">更新日志</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-Flume学习" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/" class="article-date">
      <time datetime="2019-01-17T16:00:00.000Z" itemprop="datePublished">2019-01-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Flume学习
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/HDFS/">HDFS</a>
    </div>


        
    <div class="article-tag tagcloud" style="display: flex; flex-wrap: wrap">  
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flume/" rel="tag">flume</a></li></ul>
		<span class="post-count">总字数4k</span>
		<span class="post-count">预计阅读20分钟</span>		  
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
		  
			
		
        <h2 id="一、理论理解"><a href="#一、理论理解" class="headerlink" title="一、理论理解"></a>一、理论理解</h2><p>1、官网:：<a target="_blank" rel="noopener" href="http://flume.apache.org/">http://flume.apache.org/</a></p>
<p>2、概念：</p>
<p>​    Flume是一个分布式、可扩展、可靠、高可用的海量日志有效聚合及移动的框架。</p>
<p>​    它通常用于log数据，支持在系统中定制各类数据发送方，用于收集数据。它具有可靠性和容错可调机制和许多故障转移和恢复机制</p>
<p><img src="https://wx1.sinaimg.cn/large/005zftzDly1g1jra7eyl9j30gi0e5jt8.jpg"></p>
<p>3、Flume1.0X         —-FlumeNG</p>
<p>flume1.0x版本中flume只有agent,由3个部分组成</p>
<p><img src="https://wx1.sinaimg.cn/large/005zftzDly1g1jrc5v43yj30me071q39.jpg" alt="FlumeNG"></p>
<p>4、架构解释</p>
<p>Agent ：将数据源的数据发送给collector ，Agent由source、channel、sink三大组件组成。</p>
<ul>
<li>Source：</li>
</ul>
<blockquote>
<p>  从Client收集数据，传递给Channel。可以接收外部源发送过来的数据。</p>
<p>  不同的 source，可以接受不同的数据格式。</p>
<p>  比如有目录池(spooling directory)数据源，可以监控指定文件夹中的新文件变化，如果目录中有文件产生，就会立刻读取其内容。</p>
</blockquote>
<ul>
<li>Channel</li>
</ul>
<blockquote>
<p> 是一个存储地，接收source的输出，直到有sink消费掉channel中的数据，Channel中的数据直到进入到下一个channel中或者进入终端才会被删除；</p>
<p>当sink写入失败后，可以自动重启，不会造成数据丢失，因此很可靠。</p>
</blockquote>
<ul>
<li>Sink</li>
</ul>
<blockquote>
<p>用于数据输出</p>
</blockquote>
<p>4、Flume使用原理图</p>
<p><img src="https://wx1.sinaimg.cn/large/005zftzDly1g1jrhaxmslj30mx0dbju2.jpg"></p>
<p>Flume使用Agent内部原理图</p>
<p><img src="https://wx1.sinaimg.cn/large/005zftzDly1g1jri44xz1j30l80d00uq.jpg"></p>
<h2 id="二、特点"><a href="#二、特点" class="headerlink" title="二、特点"></a>二、特点</h2><h3 id="A、数据可靠性（内部实现）"><a href="#A、数据可靠性（内部实现）" class="headerlink" title="A、数据可靠性（内部实现）"></a>A、数据可靠性（内部实现）</h3><p>​     当节点出现故障时，日志能够被传送到其他节点上而不会丢失。</p>
<p> Flume提供了三种级别的可靠性保障,从强到弱依次分别为：</p>
<p>​    1、end-to-end：收到数据agent首先将event写到磁盘上，当数据传送成功后，再删除；如果数据发送失败，可以重新发送。</p>
<p>​    2、Store on failure：当数据接收方crash时</p>
<p>​    3、Best effort：数据发送到接收方后，不会进行确认。(udp)</p>
<h3 id="B、自身可扩展性"><a href="#B、自身可扩展性" class="headerlink" title="B、自身可扩展性"></a>B、自身可扩展性</h3><ul>
<li><p>Flume采用了三层架构，分别为agent，collector和storage，每一层均可以水平扩展。所有agent和 collector由master统一管理，使得系统容易监控和维护。master允许有多个（使用ZooKeeper进行管理和负载均衡），避免单点故障问题。</p>
</li>
<li><p>【1.0自身agent实现扩展】</p>
</li>
</ul>
<h3 id="C、功能可扩展性"><a href="#C、功能可扩展性" class="headerlink" title="C、功能可扩展性"></a>C、功能可扩展性</h3><p>  用户可以根据需要添加自己的agent。</p>
<p>   Flume自带了很多组件，包括各种agent（file，syslog，HDFS等）</p>
<h2 id="三、Flume安装"><a href="#三、Flume安装" class="headerlink" title="三、Flume安装"></a>三、Flume安装</h2><p>​       1)将下载的flume包，解压</p>
<p>　　2)修改 flume-env.sh 配置文件,主要是JAVA_HOME设置[可选局部环境变量设置]</p>
<p>​        3)验证是否安装成功 flume-ng version</p>
<p>telnet 相关安装：</p>
<p>​     yum list telnet*   查看telnet相关的安装包</p>
<p>​     直接yum –y install telnet 就OK</p>
<p>​     yum -y install telnet-server 安装telnet服务</p>
<p>​     yum -y install telnet-client  安装telnet客户端(大部分系统默认安装)</p>
<h2 id="四、分类"><a href="#四、分类" class="headerlink" title="四、分类"></a>四、分类</h2><pre><code>Flume 关于Event的笔记
　　在Flume中使用Event对象来作为传递数据的格式。
　　Sources端在flume-ng-core子项目中的org.apache.flume.serialization包下，有一个名为LineDeserializer的类，这个类负责把数据按行来读取，每一行封装成一个Event（实现方式：按字节读取，当遇到&quot;\n&quot;时封装成Event返回，下一次获取Event时继续获取下一字节并判断）。然后按用户设置的批量传输的值来封装List&lt;Event&gt;

备注：

capacity：默认该通道中最大的可以存储的event数量是1000

trasactionCapacity：每次最大可以source中拿到或者送到sink中的event数量也是100
</code></pre>
<p><code>exec</code>：</p>
<blockquote>
<p> Unix等操作系统执行命令行，如tail ，cat 。可监听文件</p>
</blockquote>
<p><code>netcat</code></p>
<blockquote>
<p>监听一个指定端口，并将接收到的数据的每一行转换为一个event事件</p>
</blockquote>
<p><code>avro</code></p>
<blockquote>
<p>序列化的一种，实现RPC（一种远程过程调用协议）。</p>
<p>监听AVRO端口来接收外部AVRO客户端事件流</p>
</blockquote>
<h3 id="1、-netcat（监听端口，在本地控制台打印）"><a href="#1、-netcat（监听端口，在本地控制台打印）" class="headerlink" title="1、 netcat（监听端口，在本地控制台打印）"></a>1、 netcat（监听端口，在本地控制台打印）</h3><h4 id="（1）-vim-netcat-logger"><a href="#（1）-vim-netcat-logger" class="headerlink" title="（1） vim netcat_logger"></a>（1） vim netcat_logger</h4><pre><code># example.conf: A single-node Flume configuration

# Name the components on this agent
a1.sources = r1
a1.sinks = k1
a1.channels = c1

# Describe/configure the source
a1.sources.r1.type = netcat
a1.sources.r1.bind = localhost
a1.sources.r1.port = 44444

# Describe the sink
a1.sinks.k1.type = logger

# Use a channel which buffers events in memory
a1.channels.c1.type = memory
a1.channels.c1.capacity = 1000
a1.channels.c1.transactionCapacity = 100

# Bind the source and sink to the channel
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1</code></pre>
<h4 id="（2）命令操作"><a href="#（2）命令操作" class="headerlink" title="（2）命令操作"></a>（2）命令操作</h4><ul>
<li>（在会话1端）</li>
</ul>
<blockquote>
<p>在node00节点的控制台输入<code>启动</code>命令：</p>
<p>(<code>方式一</code>：指定配置文件的路径+文件名)</p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent --conf-file /root/flume/netcat_logger --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>（<code>方式二</code>：配置文件所在当前目录）</p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent --conf ./ --conf-file netcat_logger --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p><code>特别注意</code>：</p>
<p>#####<code>官网方式</code>#########</p>
<blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent --conf conf --conf-file netcat_logger --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>解释：此命令适用于将配置文件放在flume解压安装目录的conf中（不常用）</p>
</blockquote>
<p><code>控制台显示</code>:</p>
<pre><code>​````````
19/01/18 12:27:31 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started
19/01/18 12:27:31 INFO node.Application: Starting Sink k1
19/01/18 12:27:31 INFO node.Application: Starting Source r1
19/01/18 12:27:31 INFO source.NetcatSource: Source starting
19/01/18 12:27:31 INFO source.NetcatSource: Created serverSocket:sun.nio.ch.ServerSocketChannelImpl[/127.0.0.1:44444]</code></pre>
<ul>
<li>(在会话2端)</li>
</ul>
<blockquote>
<p>在node00节点的控制台输入命令：</p>
<p>1、在节点上安装telnet</p>
<pre class="line-numbers language-shell"><code class="language-shell">yum install -y telnet
yum -y install telnet-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>2、启动：</p>
<pre class="line-numbers language-shell"><code class="language-shell">telnet localhost 44444  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>注意：</code>：</p>
<pre><code>a1.sources.r1.bind = localhost  # 监控本地端口44444的数据</code></pre>
<p>前提是/etc/hosts中已经配置</p>
<p>如果此处配置localhost 那么启动时，localhost  或127.0.0.1都可以，node00就不行</p>
<p>如果此处配置node00那么启动时，node00或ip都可以，localhost就不行</p>
<p>3、在会话2控制台输入任何内容;</p>
<p>都会在会话1端显示，且会话1端（ctrl+c）退出服务，会话2端也自动结束</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">  yum list telnet*   查看telnet相关的安装包
   直接yum –y install telnet 就OK
     yum -y install telnet-server 安装telnet服务
     yum -y install telnet-client  安装telnet客户端(大部分系统默认安装)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2、avro（监听远程发送文件，在本地控制台打印）"><a href="#2、avro（监听远程发送文件，在本地控制台打印）" class="headerlink" title="2、avro（监听远程发送文件，在本地控制台打印）"></a>2、avro（监听远程发送文件，在本地控制台打印）</h3><h4 id="（1）vim-avro-logger"><a href="#（1）vim-avro-logger" class="headerlink" title="（1）vim avro_logger"></a>（1）vim avro_logger</h4><pre><code>#test avro sources
##使用avro方式在某节点上将文件发送到本服务器上且通过logger方式显示
##当前flume节点执行：
#flume-ng agent --conf ./ --conf-file avro_loggers --name a1 -Dflume.root.logger=INFO,console
##其他flume节点执行：
#flume-ng avro-client --conf ./ -H 192.168.198.128 -p 55555 -F ./logs

a1.sources=r1
a1.channels=c1
a1.sinks=k1

a1.sources.r1.type = avro  
a1.sources.r1.bind=192.168.198.128
a1.sources.r1.port=55555

a1.sinks.k1.type=logger

a1.channels.c1.type = memory
a1.channels.c1.capacity=1000
a1.channels.c1.transactionCapacity = 100

a1.sources.r1.channels=c1
a1.sinks.k1.channel=c1</code></pre>
<p>实现功能：</p>
<blockquote>
<p>使用avro方式在某节点上将文件发送到本服务器上且通过logger方式显示</p>
</blockquote>
<h4 id="（2）命令操作-1"><a href="#（2）命令操作-1" class="headerlink" title="（2）命令操作"></a>（2）命令操作</h4><h5 id="启动"><a href="#启动" class="headerlink" title="启动"></a><code>启动</code></h5><p>（在会话1端）</p>
<p>在node00上</p>
<ul>
<li>当前flume节点执行（配置文件在当前目录）：</li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent --conf ./ --conf-file avro_logger --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>显示：</code></p>
<pre><code>19/01/18 13:53:16 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started
19/01/18 13:53:16 INFO node.Application: Starting Sink k1
19/01/18 13:53:16 INFO node.Application: Starting Source r1
19/01/18 13:53:16 INFO source.AvroSource: Starting Avro source r1: &amp;#123; bindAddress: 192.168.198.128, port: 55555 &amp;#125;...
19/01/18 13:53:17 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: SOURCE, name: r1: Successfully registered new MBean.
19/01/18 13:53:17 INFO instrumentation.MonitoredCounterGroup: Component type: SOURCE, name: r1 started
19/01/18 13:53:17 INFO source.AvroSource: Avro source r1 started.
</code></pre>
<h5 id="发送"><a href="#发送" class="headerlink" title="发送"></a>发送</h5><p>(在会话2端)</p>
<p>在node00上发送文件到node00</p>
<p><code>启动</code></p>
<p>可在本地和其他flume节点执行（配置文件在当前目录）：</p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng avro-client --conf ./ -H 192.168.198.128 -p 55555 -F ./flume.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>(在会话1端)</p>
<pre><code>19/01/18 14:12:57 INFO sink.LoggerSink: 
Event: 
&amp;#123; headers:&amp;#123;&amp;#125; body: 68 65 6C 6C 6F 20 62 69 67 64 61 74 61          hello bigdata &amp;#125;</code></pre>
<p>时刻监听传输文件的内容</p>
<p><code>注意</code></p>
<blockquote>
<p>该过程也可应用于不同节点之间</p>
</blockquote>
<h3 id="3、exec（监听某一命令，在本地控制台打印）"><a href="#3、exec（监听某一命令，在本地控制台打印）" class="headerlink" title="3、exec（监听某一命令，在本地控制台打印）"></a>3、exec（监听某一命令，在本地控制台打印）</h3><h4 id="（1）vim-exec-logger"><a href="#（1）vim-exec-logger" class="headerlink" title="（1）vim exec_logger"></a>（1）vim exec_logger</h4><pre><code>#单节点flume配置
# example.conf: A single-node Flume configuration   

#给agent三大结构命名
# Name the components on this agent
a1.sources = r1
a1.sinks = k1
a1.channels = c1

#描述source的配置：类型、命令（监听/root/flume.log文件）
# Describe/configure the source
a1.sources.r1.type = exec
a1.sources.r1.command = tail -F /root/flume.log

#描述sink的配置：类型
# Describe the sink
a1.sinks.k1.type = logger

#在内存中使用一个channel缓存事件
# Use a channel which buffers events in memory
a1.channels.c1.type = memory
a1.channels.c1.capacity = 1000
a1.channels.c1.transactionCapacity = 100

#将source和sink绑定到channel上
# Bind the source and sink to the channel
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1
</code></pre>
<p>（xshell会话1：）</p>
<blockquote>
<p>在node00上：<code>启动</code></p>
<p>在exec_logger文件所在的目录下</p>
<p>命令：</p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent  --conf-file exec_logger --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>r1 启动</p>
</blockquote>
<blockquote>
<p>（复制会话：会话2）</p>
<p>在node00上：</p>
<p>在root目录下</p>
<p>命令：</p>
<pre class="line-numbers language-shell"><code class="language-shell">echo hello bigdata >>flume.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<blockquote>
<p>之后在会话1上</p>
<p><code>logger本地控制台打印：</code></p>
<pre><code>19/01/18 12:03:23 INFO sink.LoggerSink: 
Event: 
&amp;#123; headers:&amp;#123;&amp;#125; body: 68 65 6C 6C 6F 20 62 69 67 64 61 74 61  hello bigdata &amp;#125;</code></pre>
</blockquote>
<h3 id="4、netcat–hdfs-监听数据，传到hdfs上"><a href="#4、netcat–hdfs-监听数据，传到hdfs上" class="headerlink" title="4、netcat–hdfs(监听数据，传到hdfs上)"></a>4、netcat–hdfs(监听数据，传到hdfs上)</h3><h4 id="（1）vim-netcat-hdfs"><a href="#（1）vim-netcat-hdfs" class="headerlink" title="（1）vim netcat_hdfs"></a>（1）vim netcat_hdfs</h4><pre><code># a1 which ones we want to activate.
a1.channels = c1
a1.sources = r1
a1.sinks = k1

a1.sources.r1.type = netcat
a1.sources.r1.bind = node00
a1.sources.r1.port = 41414

a1.sinks.k1.type = hdfs
a1.sinks.k1.hdfs.path = hdfs://Sunrise/myflume/%y-%m-%d
a1.sinks.k1.hdfs.useLocalTimeStamp=true

# Define a memory channel called c1 on a1
a1.channels.c1.type = memory
#默认值，可省
#a1.channels.c1.capacity = 1000
#a1.channels.c1.transactionCapacity = 100

# Define an Avro source called r1 on a1 and tell it
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1</code></pre>
<h4 id="2-操作"><a href="#2-操作" class="headerlink" title="(2)操作"></a>(2)操作</h4><p>在node00的会话1上</p>
<p>启动</p>
<blockquote>
<p>在node00上：</p>
<p>在netcat_hdfs文件所在的目录下</p>
<p>命令：</p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent  --conf-file netcat_hdfs --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>显示：</p>
<pre><code>19/01/18 14:34:44 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started
19/01/18 14:34:44 INFO node.Application: Starting Sink k1
19/01/18 14:34:44 INFO node.Application: Starting Source r1
19/01/18 14:34:44 INFO source.NetcatSource: Source starting
19/01/18 14:34:44 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: SINK, name: k1: Successfully registered new MBean.
19/01/18 14:34:44 INFO instrumentation.MonitoredCounterGroup: Component type: SINK, name: k1 started
19/01/18 14:34:44 INFO source.NetcatSource: Created serverSocket:sun.nio.ch.ServerSocketChannelImpl[/192.168.198.128:41414]
</code></pre>
<p>在node00的会话2上</p>
<p>启动</p>
<pre class="line-numbers language-shell"><code class="language-shell">telnet node00 41414<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>显示</p>
<pre><code>Trying 192.168.198.128...
Connected to node00.
Escape character is &#39;^]&#39;.
</code></pre>
<p>输入任意内容</p>
<p>在node00会话1端会显示</p>
<pre><code>19/01/18 14:36:50 INFO hdfs.HDFSSequenceFile: writeFormat = Writable, UseRawLocalFileSystem = false
19/01/18 14:36:51 INFO hdfs.BucketWriter: Creating hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259.tmp
19/01/18 14:37:29 INFO hdfs.BucketWriter: Closing hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259.tmp
19/01/18 14:37:29 INFO hdfs.BucketWriter: Renaming hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259.tmp to hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259
19/01/18 14:37:29 INFO hdfs.HDFSEventSink: Writer callback called.
</code></pre>
<p>在HDF分布式系统上会显示，生成的文件</p>
<p><img src="https://wx1.sinaimg.cn/large/005zftzDgy1fzb4acaz5fj30u10blmzc.jpg"></p>
<p><img src="https://wx1.sinaimg.cn/large/005zftzDgy1fzb4bsv8d2j30wd08k74i.jpg"></p>
<p><code>注意：</code></p>
<p>这种情况会在hdfs上生成很多小文件，</p>
<p><a target="_blank" rel="noopener" href="http://flume.apache.org/releases/content/1.8.0/FlumeUserGuide.html">在官网</a></p>
<p>HDFS Sink：<a target="_blank" rel="noopener" href="http://flume.apache.org/releases/content/1.8.0/FlumeUserGuide.html#hdfs-sink"><em>文档</em></a></p>
<p>有很多关于文件生成过程中的配置</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><strong>channel</strong></td>
<td>–</td>
<td></td>
</tr>
<tr>
<td><strong>type</strong></td>
<td>–</td>
<td>The component type name, needs to be <code>hdfs</code></td>
</tr>
<tr>
<td><strong>hdfs.path</strong></td>
<td>–</td>
<td>HDFS directory path (eg hdfs://namenode/flume/webdata/)</td>
</tr>
<tr>
<td>hdfs.filePrefix</td>
<td>FlumeData</td>
<td>Name prefixed to files created by Flume in hdfs directory</td>
</tr>
<tr>
<td>hdfs.fileSuffix</td>
<td>–</td>
<td>Suffix to append to file (eg <code>.avro</code> - <em>NOTE: period is not automatically added</em>)</td>
</tr>
<tr>
<td>hdfs.inUsePrefix</td>
<td>–</td>
<td>Prefix that is used for temporal files that flume actively writes into</td>
</tr>
<tr>
<td>hdfs.inUseSuffix</td>
<td><code>.tmp</code></td>
<td>Suffix that is used for temporal files that flume actively writes into</td>
</tr>
<tr>
<td>hdfs.rollInterval</td>
<td>30</td>
<td>Number of seconds to wait before rolling current file (0 = never roll based on time interval)</td>
</tr>
<tr>
<td>hdfs.rollSize</td>
<td>1024</td>
<td>File size to trigger roll, in bytes (0: never roll based on file size)</td>
</tr>
<tr>
<td>hdfs.rollCount</td>
<td>10</td>
<td>Number of events written to file before it rolled (0 = never roll based on number of events)</td>
</tr>
<tr>
<td>hdfs.idleTimeout</td>
<td>0</td>
<td>Timeout after which inactive files get closed (0 = disable automatic closing of idle files)</td>
</tr>
<tr>
<td>hdfs.batchSize</td>
<td>100</td>
<td>number of events written to file before it is flushed to HDFS</td>
</tr>
<tr>
<td>hdfs.codeC</td>
<td>–</td>
<td>Compression codec. one of following : gzip, bzip2, lzo, lzop, snappy</td>
</tr>
<tr>
<td>hdfs.fileType</td>
<td>SequenceFile</td>
<td>File format: currently <code>SequenceFile</code>, <code>DataStream</code> or <code>CompressedStream</code> <br>(1)DataStream will not compress output file and please don’t set codeC<br> (2)CompressedStream requires set hdfs.codeC with an available codeC</td>
</tr>
<tr>
<td>hdfs.maxOpenFiles</td>
<td>5000</td>
<td>Allow only this number of open files. If this number is exceeded, the oldest file is closed.</td>
</tr>
<tr>
<td>hdfs.minBlockReplicas</td>
<td>–</td>
<td>Specify minimum number of replicas per HDFS block. If not specified, it comes from the default Hadoop config in the classpath.</td>
</tr>
<tr>
<td>hdfs.writeFormat</td>
<td>Writable</td>
<td>Format for sequence file records. One of <code>Text</code> or <code>Writable</code>. Set to <code>Text</code> before creating data files with Flume, otherwise those files cannot be read by either Apache Impala (incubating) or Apache Hive.</td>
</tr>
<tr>
<td>hdfs.callTimeout</td>
<td>10000</td>
<td>Number of milliseconds allowed for HDFS operations, such as open, write, flush, close. This number should be increased if many HDFS timeout operations are occurring.</td>
</tr>
<tr>
<td>hdfs.threadsPoolSize</td>
<td>10</td>
<td>Number of threads per HDFS sink for HDFS IO ops (open, write, etc.)</td>
</tr>
<tr>
<td>hdfs.rollTimerPoolSize</td>
<td>1</td>
<td>Number of threads per HDFS sink for scheduling timed file rolling</td>
</tr>
<tr>
<td>hdfs.kerberosPrincipal</td>
<td>–</td>
<td>Kerberos user principal for accessing secure HDFS</td>
</tr>
<tr>
<td>hdfs.kerberosKeytab</td>
<td>–</td>
<td>Kerberos keytab for accessing secure HDFS</td>
</tr>
<tr>
<td>hdfs.proxyUser</td>
<td></td>
<td></td>
</tr>
<tr>
<td>hdfs.round</td>
<td>false</td>
<td>Should the timestamp be rounded down (if true, affects all time based escape sequences except %t)</td>
</tr>
<tr>
<td>hdfs.roundValue</td>
<td>1</td>
<td>Rounded down to the highest multiple of this (in the unit configured using <code>hdfs.roundUnit</code>), less than current time.</td>
</tr>
<tr>
<td>hdfs.roundUnit</td>
<td>second</td>
<td>The unit of the round down value - <code>second</code>, <code>minute</code> or <code>hour</code>.</td>
</tr>
<tr>
<td>hdfs.timeZone</td>
<td>Local Time</td>
<td>Name of the timezone that should be used for resolving the directory path, e.g. America/Los_Angeles.</td>
</tr>
<tr>
<td>hdfs.useLocalTimeStamp</td>
<td>false</td>
<td>Use the local time (instead of the timestamp from the event header) while replacing the escape sequences.</td>
</tr>
<tr>
<td>hdfs.closeTries</td>
<td>0</td>
<td>Number of times the sink must try renaming a file, after initiating a close attempt. <br>If set to 1, this sink will not re-try a failed rename (due to, for example, NameNode or DataNode failure), and may leave the file in an open state with a .tmp extension.<br> If set to 0, the sink will try to rename the file until the file is eventually renamed (there is no limit on the number of times it would try). The file may still remain open if the close call fails but the data will be intact and in this case, the file will be closed only after a Flume restart.</td>
</tr>
<tr>
<td>hdfs.retryInterval</td>
<td>180</td>
<td>Time in seconds between consecutive attempts to close a file. Each close call costs multiple RPC round-trips to the Namenode, so setting this too low can cause a lot of load on the name node. If set to 0 or less, the sink will not attempt to close the file if the first attempt fails, and may leave the file open or with a ”.tmp” extension.</td>
</tr>
<tr>
<td>serializer</td>
<td><code>TEXT</code></td>
<td>Other possible options include <code>avro_event</code> or the fully-qualified class name of an implementation of the <code>EventSerializer.Builder</code> interface.</td>
</tr>
</tbody></table>
<h3 id="avro-hdfs"><a href="#avro-hdfs" class="headerlink" title="avro-hdfs"></a>avro-hdfs</h3><p>（配置方式二）</p>
<pre><code># a1 which ones we want to activate.
a1.channels = c1
a1.sources = r1
a1.sinks = k1

a1.sources.r1.type = avro
a1.sources.r1.bind=node01
a1.sources.r1.port=55555

a1.sinks.k1.type = hdfs
a1.sinks.k1.hdfs.path = hdfs://shsxt/hdfsflume

# Define a memory channel called c1 on a1
a1.channels.c1.type = memory
a1.channels.c1.capacity=1000
a1.channels.c1.transactionCapacity = 100

# Define an Avro source called r1 on a1 and tell it
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1</code></pre>
<p>##当前flume节点执行：<br>#flume-ng agent –conf ./ –conf-file avro_loggers –name a1 -Dflume.root.logger=INFO,console<br>##其他flume节点执行：<br>#flume-ng avro-client –conf ./ -H 192.168.198.128 -p 55555 -F ./logs</p>
<h3 id="5、结合版（netcat-avro）"><a href="#5、结合版（netcat-avro）" class="headerlink" title="5、结合版（netcat-avro）"></a>5、结合版（netcat-avro）</h3><h4 id="（1）编辑配置文件"><a href="#（1）编辑配置文件" class="headerlink" title="（1）编辑配置文件"></a>（1）编辑配置文件</h4><p>（node00：vim netcat_avro1）</p>
<pre><code># example.conf: A single-node Flume configuration
#flume-ng agent --conf ./ --conf-file netcat_avro1 --name a1 -Dflume.root.logger=INFO,console
#flume-ng --conf conf --conf-file /root/flume_test/netcat_hdfs -n a1 -Dflume.root.logger=INFO,console
#telnet 192.168.235.15 44444
# Name the components on this agent
 a1.sources = r1
 a1.sinks = k1
 a1.channels = c1

 # Describe/configure the source
 a1.sources.r1.type = netcat
 a1.sources.r1.bind = node00
 a1.sources.r1.port = 44444

 # Describe the sink
 a1.sinks.k1.type = avro
 a1.sinks.k1.hostname = node01
 a1.sinks.k1.port = 60000


 # Use a channel which buffers events in memory
 a1.channels.c1.type = memory
 a1.channels.c1.capacity = 1000
 a1.channels.c1.transactionCapacity = 100

 # Bind the source and sink to the channel
 a1.sources.r1.channels = c1
 a1.sinks.k1.channel = c1

#---------------------------
#flume-ng agent --conf-file etect2_logger --name a1 -#Dflume.root.logger=INFO,console

#flume-ng agent --conf conf --conf-file netcat_logger --name a1 -#Dflume.root.logger=INFO,console</code></pre>
<p>（node01：netcat_avro2）</p>
<pre><code>#flume-ng agent --conf ./ --conf-file avro2 -n a1 
a1.sources = r1
a1.sinks = k1
a1.channels = c1

a1.sources.r1.type = avro
a1.sources.r1.bind = node01
a1.sources.r1.port = 60000

a1.sinks.k1.type = logger

# Use a channel which buffers events in memory
a1.channels.c1.type = memory
a1.channels.c1.capacity = 1000
a1.channels.c1.transactionCapacity = 100

# Bind the source and sink to the channel
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1
</code></pre>
<p>(2)操作</p>
<blockquote>
<p>先启动后面的flume节点node01  ，在启动node00，最后启动node02</p>
</blockquote>
<p>在node01上</p>
<p><code>启动</code></p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent --conf conf --conf-file netcat_avro1 -n a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>显示</p>
<pre><code>19/01/18 23:22:27 INFO node.Application: Starting Channel c1
19/01/18 23:22:28 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: CHANNEL, name: c1: Successfully registered new MBean.
19/01/18 23:22:28 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started
19/01/18 23:22:28 INFO node.Application: Starting Sink k1
19/01/18 23:22:28 INFO node.Application: Starting Source r1
19/01/18 23:22:28 INFO source.AvroSource: Starting Avro source r1: &amp;#123; bindAddress: node01, port: 60000 &amp;#125;...
19/01/18 23:22:30 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: SOURCE, name: r1: Successfully registered new MBean.
19/01/18 23:22:30 INFO instrumentation.MonitoredCounterGroup: Component type: SOURCE, name: r1 started
19/01/18 23:22:30 INFO source.AvroSource: Avro source r1 started.</code></pre>
<p>在node00上：</p>
<p><code>启动</code></p>
<pre class="line-numbers language-shell"><code class="language-shell">flume-ng agent --conf ./ --conf-file netcat_avro2 --name a1 -Dflume.root.logger=INFO,console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在node02上</p>
<p><code>启动</code></p>
<blockquote>
<p>telnet node00 44444</p>
</blockquote>
<p>然后输入数据文件</p>
<p>最后在</p>
<p>node01节点上</p>
<p>显示文件信息</p>
<pre><code>19/01/18 23:33:01 INFO sink.LoggerSink: Event: &amp;#123; headers:&amp;#123;&amp;#125; body: 68 65 6C 6C 6F 20 77 6F 72 6C 64 0D             hello world. &amp;#125;
</code></pre>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/">Flume学习</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">Sukie</a></p>
        <p><span>Created:</span>2019-01-18, 00:00:00</p>
        <p><span>Updated:</span>2020-08-07, 21:07:21</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/" title="Flume学习">https://sukie-sun.github.io/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/</a>
            <span class="copy-path" data-clipboard-text="From https://sukie-sun.github.io/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/　　By Sukie" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2019/01/18/CDH%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0/">
                    CDH部署操作
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2019/01/17/HBase%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">
                    HBase性能优化
                </a>
            </div>
        
    </nav>

  
</article>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Flume学习　| Sukie's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
	  <section id="comments" style="margin: 2em; padding: 2em; background: rgba(255, 255, 255, 0.5)">
    <div id="vcomment" class="comment"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@1.2.0-beta1/dist/Valine.min.js"></script>
    <script>
      new Valine({
        el: '#vcomment',
        notify: 'true',
        verify: 'true',
        app_id: "qha2YfPRUR6IN1LfnbliYqay-gzGzoHsz",
        app_key: "b00TckRiHRVQphnJwuFp9isO",
        placeholder: "Just go go!",
        avatar: "mp"
      });
    </script>
</section>	  
    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2019/01/18/CDH%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0/" title="Pre: CDH部署操作">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2019/01/17/HBase%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="Next: HBase性能优化">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/08/08/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/22/Spark(6)/">Spark学习（六）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/21/Spark(5)/">Spark学习（五）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/19/Spark(4)/">Spark学习（四）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/18/Spark(3)/">Spark学习（三）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/17/Spark(2)/">Spark学习（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/Spark(1)/">Spark学习（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/List%E6%96%B9%E6%B3%95/">List方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/Map%E6%96%B9%E6%B3%95/">Map方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/Set%E6%96%B9%E6%B3%95/">Set方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/String%E6%96%B9%E6%B3%95/">String 方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95/">数组方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/">面试问题总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/15/Scala%E5%AD%A6%E4%B9%A0/">Scala学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/14/Redis%E5%AD%A6%E4%B9%A0/">Redis学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/29/Storm%E5%AD%A6%E4%B9%A0/">Storm学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/28/Kafka%E5%AD%A6%E4%B9%A0/">Kafka学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/25/Elasticsearch%E5%AD%A6%E4%B9%A0/">Elasticsearch学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/18/CDH%E6%93%8D%E4%BD%9C%E5%AD%A6%E4%B9%A0/">CDH部署操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/18/Flume%E5%AD%A6%E4%B9%A0/">Flume学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/17/HBase%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">HBase性能优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/15/HBase%E5%AD%A6%E4%B9%A0/">HBase学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/13/Sqoop%E5%AD%A6%E4%B9%A0/">Sqoop学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/12/Hive%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84UDF%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">Hive中常用的UDF函数总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/12/Hive%E4%BC%98%E5%8C%96/">Hive优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/11/Hive%E5%AD%A6%E4%B9%A0/">Hive学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/08/MapReduce%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">MapReduce源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/07/MapReduce%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/">MapReduce案例实践</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/05/MapReduce%E5%AD%A6%E4%B9%A0/">MapReduce学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/04/Zookeeper%E5%AD%A6%E4%B9%A0/">Zookeeper学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/04/Yarn%E5%AD%A6%E4%B9%A0/">YARN的入门学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/03/Hadoop2.X/">Hadoop2.X</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/03/HDFS%E5%AD%A6%E4%B9%A0/">HDFS学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/02/Nginx%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A02/">Nginx入门学习（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/02/Nginx%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A01/">Nginx入门学习（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/30/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%80%9D%E6%83%B3/">大数据思想</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/29/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AD%A6%E4%B9%A03/">常用Linux命令的学习（三）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/28/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AD%A6%E4%B9%A02/">常用Linux命令的学习（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/27/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AD%A6%E4%B9%A01/">常用Linux命令的学习（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/26/Linux%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93MySQL%E5%AE%89%E8%A3%85/">Linux系统数据库MySQL安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/25/Linux%E7%B3%BB%E7%BB%9FCentOS%206%E5%AE%89%E8%A3%85/">Linux学习之CentOS 6系统安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/24/%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85maven%E5%9D%90%E6%A0%87%E4%BE%9D%E8%B5%96/">手动安装maven坐标依赖</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/16/hexo/">Hexo搭建个人博客</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017-2020 Sukie
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>


    </div>
    
    
<script src="/js/GithubRepoWidget.js"></script>


<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

  <script>
    $(document).ready(function() {
      var iPad = window.navigator.userAgent.indexOf('iPad');
      if (iPad > -1) {
        let bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
        let bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
        $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
      } else if ($(".left-col").css("display") === "none") {
        $("body").css({
          "background-image": "url(/background/mobile.jpg)",
          "background-repeat": "no-repeat",
          "background-attachment": "fixed",
          "background-size": "cover"
        })
      } else {
        var backgroundnum = 5;
        var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
        $("body").css({
          "background": backgroundimg,
          "background-position": "0% 80%",
          "background-attachment": "fixed",
          "background-size": "cover"
        })
      }
    })
  </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
            
            
            
            
             archives: ".archive-article-title", 
            
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script src="/js/busuanzi_pure_mini.js"></script>
  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?6b4caaf6c3a0542e82c2abbce9da41cc"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/chitose.model.json"},"display":{"position":"right","width":250,"height":350,"hOffset":-50,"vOffset":-85},"mobile":{"show":false},"react":{"opacityDefault":0.9,"opacityOnHover":0.3}});</script></body>
</html>